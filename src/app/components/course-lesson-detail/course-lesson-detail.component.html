<div class="lesson-detail-container">
  <div class="lesson-header">
    <div class="timer-display" *ngIf="remainingTime !== null">
      <h3>â±ï¸ Time Remaining: {{ getFormattedTime() }}</h3>
    </div>
  </div>

  <div class="lesson-content" *ngIf="!loading && !error && lesson">
    <!-- H1: Lesson Title First -->
    <div class="lesson-header-section">
      <h1 class="lesson-title">{{ lesson.title }}</h1>
      
      <div class="lesson-actions">
        <button class="btn btn-primary" (click)="toggleVideoComponent()" *ngIf="lesson.animation3dUrl && !showVideoComponent">
          ğŸ“· Show Webcam
        </button>
        <button class="btn btn-secondary" (click)="toggleVideoComponent()" *ngIf="showVideoComponent">
          âŒ Hide Webcam
        </button>
      </div>
    </div>
    
    <!-- Video Section Second -->
    <div class="lesson-media" *ngIf="lesson.videoUrl">
      <div class="video-section">
        <h3>ğŸ¥ Video Content</h3>
        <video [src]="sanitizeResourceUrl(lesson.videoUrl)" controls width="100%"></video>
      </div>
    </div>
    
    <!-- Description Third -->
    <div class="lesson-description" *ngIf="lesson.description">
      <div class="processed-content" [innerHTML]="processedDescription"></div>
    </div>

    <div class="lesson-content-section" *ngIf="lesson.contentTitle || lesson.contentDescription">
      <h2 *ngIf="lesson.contentTitle">{{ lesson.contentTitle }}</h2>
      <div class="processed-content" [innerHTML]="processedContentDescription" *ngIf="lesson.contentDescription"></div>
    </div>

    <!-- 3D Animation component last (hidden since it doesn't exist yet) -->
    <div class="animation-section" *ngIf="lesson.animation3dUrl" style="display: none;">
      <h3>ğŸ® 3D Animation</h3>
      <app-video *ngIf="showVideoComponent" [videoUrl]="lesson.animation3dUrl" [lessonId]="lesson.id"></app-video>
    </div>
  </div>

  <div class="loading" *ngIf="loading">
    <p>Loading lesson...</p>
  </div>

  <div class="error" *ngIf="error">
    <p>{{ error }}</p>
    <button class="btn btn-primary" (click)="loadCourseLesson(lesson?.id || 0)" *ngIf="!error.includes('expired') && !error.includes('access time has expired')">Retry</button>
  </div>
</div>